<a onclick="close_action();" class='overlay' id='type_action'></a>
    <div id="savebtn" style="float: left; width: 400px">
        <form action="<?=$_SERVER['REQUEST_URI']?>" method="get" style="float: left">
            <input type="hidden" name="order_id" id="order_id" value="<?=$_REQUEST['order_id']?>">
            <input type="hidden" name="type_action" value="with_list">
            <input type="hidden" name="prepared_order" value="1">
            <button style="width: 200px;height: 30px" >Додати товар зі списку</button>
        </form>
        <button style="width: 200px;height: 30px"  onclick="sendRaport();">Відіслати звіт замовнику</button>
    </div>
     <div class="tabs" data-type="horizontal" data-role="controlgroup">
         <div class="inline-block tabsElem tabsElemActive">
             <div id="basic_part" onclick="selpage(event);" class="tab inline-block" data-role="button">Основна економічна частина</div>
         </div>
         <div class="inline-block tabsElem">
             <div id="addition_part" onclick="selpage(event);" class="unactivepage tab inline-block"  data-role="button">Додаткова економічна частина</div>
         </div>
         <div class="inline-block tabsElem">
             <div id="result_part" onclick="selpage(event);" class="unactivepage tab inline-block" data-role="button">Результат</div>
         </div>
         <div class="inline-block tabsElem">
             <div id="features_part" onclick="selpage(event);" class="unactivepage tab inline-block" data-role="button">Особливості</div>
         </div>
     </div>
    <div class="tabPage">
        <table style="float: none">
            <thead>
                <!--<tr class="multiple_header_table">-->
                    <!--<th colspan="13" class="basic_part">Основна економічна частина</th>-->
                    <!--<th colspan="10" class="addition_part">Додаткова економічна частина</th>-->
                    <!--<th colspan="4" class="result_part">Результат</th>-->
                    <!--<th colspan="5" class="features_part">Особливості</th>-->
                <!--</tr>-->
                <tr class="multiple_header_table">
                    <th rowspan="2" style="width: 30px" class="middle_size"></th>
                    <th rowspan="2" style="width: 92px" class="middle_size">Виробник</th>
                    <th rowspan="2" style="width: 190px" class="middle_size">Назва товару</th>
                    <th rowspan="2" style="width: 80px" class="middle_size">№ по каталогу (артикул)</th>
                    <th rowspan="2" style="width: 60px" class="middle_size">Кільк.</th>
                    <th rowspan="2" style="width: 60px" class="middle_size">Од. виміру</th>
                    <th colspan="2" class="middle_size basic_part">закупка одиниці</th>
                    <th colspan="2" class="middle_size basic_part">закупка партії</th>
                    <th rowspan="2" style="width: 60px" class="middle_size basic_part">варт. завант.</th>
                    <th colspan="2" class="middle_size basic_part">транспорт1</th>
                    <th colspan="2" class="middle_size basic_part">транспорт2</th>
                    <th colspan="2" class="middle_size basic_part">транспорт3</th>
                    <th rowspan="2" style="width: 60px" class="middle_size basic_part">допрод. підгот.</th>
                    <th rowspan="2" style="width: 60px" class="middle_size basic_part">викор. трансп. ТіТ</th>
                    <th rowspan="2" style="width: 60px" class="middle_size addition_part">виїзд в господ.</th>
                    <th rowspan="2" style="width: 60px" class="middle_size addition_part">затрати серв. служби</th>
                    <th rowspan="2" style="width: 60px" class="middle_size addition_part">інше + подяка кліенту</th>
                    <th rowspan="2" style="width: 60px" class="middle_size addition_part">нав. розв. роботи</th>
                    <th rowspan="2" style="width: 60px" class="middle_size addition_part">банк. %</th>
                    <th rowspan="2" style="width: 60px" class="middle_size addition_part">інше</th>
                    <th rowspan="2" style="width: 60px" class="middle_size addition_part">подат. на приб.</th>
                    <th rowspan="2" style="width: 60px" class="middle_size addition_part">ПДВ</th>
                    <th colspan="2" class="middle_size addition_part">собіварт.</th>
                    <th colspan="2" class="middle_size result_part">продаж</th>
                    <th rowspan="2" style="width: 60px" class="middle_size result_part">різниця</th>
                    <th rowspan="2" style="width: 60px" class="middle_size result_part">%</th>
                    <th rowspan="2" style="width: 60px" class="middle_size features_part">Необх. % предопл.</th>
                    <th rowspan="2" style="width: 60px" class="middle_size features_part">Кінц. дата предопл.</th>
                    <th rowspan="2" style="width: 60px" class="middle_size features_part">Кінц. допл. клієнтом до, дата/подія</th>
                    <th rowspan="2" style="width: 60px" class="middle_size features_part">Дата пост. / викон.</th>
                    <th rowspan="2" style="width: 190px" class="middle_size features_part">Прим.</th>
                </tr>
                <tr class="middle_size multiple_header_table">
                    <th style="width: 60px" class="middle_size basic_part">без ПДВ</th>
                    <th style="width: 60px" class="middle_size basic_part">з ПДВ</th>
                    <th style="width: 60px" class="middle_size basic_part">без ПДВ</th>
                    <th style="width: 60px" class="middle_size basic_part">з ПДВ</th>
                    <th style="width: 60px" class="middle_size basic_part">без ПДВ</th>
                    <th style="width: 60px" class="middle_size basic_part">з ПДВ</th>
                    <th style="width: 60px" class="middle_size basic_part">без ПДВ</th>
                    <th style="width: 60px" class="middle_size basic_part">з ПДВ</th>
                    <th style="width: 60px" class="middle_size basic_part">без ПДВ</th>
                    <th style="width: 60px" class="middle_size basic_part">з ПДВ</th>
                    <th style="width: 60px" class="middle_size addition_part">без ПДВ</th>
                    <th style="width: 60px" class="middle_size addition_part">з ПДВ (+ ін.витр.)</th>
                    <th style="width: 60px" class="middle_size result_part">без ПДВ</th>
                    <th style="width: 60px" class="middle_size result_part">з ПДВ (+ ін.витр.)</th>
                </tr>
            </thead>
            <?=$order?>
        </table>

        <div style="color: #0000FF; font-weight: bold; font-size: 14px; padding: 5px 0px 5px 20px" id="title_question">Відповіді на анкетні запитання:</div>
        <div id="typicalqueries">
        <div id="question" style="max-width: 450px; width: 450px; background-color: #ffffff">
            <table class="middle_size" style="width: 100%;border-collapse: collapse">
                <tbody>
                    <?=$question?>
                </tbody>
            </table>
        </div>
        </div>
        <div style="text-align: center; width: 550px">
        <button style="width: 150px;height: 30px" onclick="saveorders();">Зберегти заявку</button>
        <button style="width: 150px;height: 30px" onclick="returnToCurrentTask();">Повернутись</button>
        </div>
    </div>
<input type="hidden" id="choosed_products" value="">
<style>
    .tabs{
        padding-left: 500px;
    }
    .tabPage{
        width: 1350px;
    }
</style>
<script>
    function sendRaport(){
        if(confirm('Відіслати звіт замовнику?')) {
            $.ajax({
                url: '/dolibarr/htdocs/orders.php?type_action=sendraport&task_id=' + getParameterByName('task_id')+'&order_id='+getParameterByName('order_id'),
                cache: false,
                success: function (result) {
//                    returnToCurrentTask();
                }
            })
        }

        console.log(getParameterByName('task_id'));
    }
    function returnToCurrentTask(){
        location.href = '/dolibarr/htdocs/current_plan.php?idmenu=10423&mainmenu=current_task&leftmenu=';
    }
    function calculator(product_id){
        var sale_price = parseFloat(Math.round($('#full_sale_price'+product_id).html()*100/1.2)/100);
        $('#sale_price'+product_id).html(sale_price);
        var incom = (sale_price - (parseFloat($('#price_per_party'+product_id).html().length==0?0: $('#price_per_party'+product_id).html())+
                                    parseFloat($('#price_per_transport1'+product_id).html().length==0?0: $('#price_per_transport1'+product_id).html())+
                                    parseFloat($('#price_per_transport2'+product_id).html().length==0?0: $('#price_per_transport2'+product_id).html())+
                                    parseFloat($('#price_per_transport3'+product_id).html().length==0?0: $('#price_per_transport3'+product_id).html())));
//        console.log(incom);
        var incom_tax = .18*incom;
        var VAT_tax = .2*incom;
        $('#incom_tax'+product_id).html(Math.round(incom_tax*100)/100);
        $('#VAT'+product_id).html(Math.round(VAT_tax*100)/100);
        var full_price_costs =
                parseFloat($('#full_price_per_party'+product_id).html().length==0?0: $('#full_price_per_party'+product_id).html())+
                parseFloat($('#price_per_download'+product_id).html().length==0?0: $('#price_per_download'+product_id).html())+
                parseFloat($('#full_price_per_transport1'+product_id).html().length==0?0: $('#full_price_per_transport1'+product_id).html())+
                parseFloat($('#full_price_per_transport2'+product_id).html().length==0?0: $('#full_price_per_transport2'+product_id).html())+
                parseFloat($('#full_price_per_transport3'+product_id).html().length==0?0: $('#full_price_per_transport3'+product_id).html())+
                parseFloat($('#prep_sale'+product_id).html().length==0?0: $('#prep_sale'+product_id).html())+
                parseFloat($('#use_owner_transport'+product_id).html().length==0?0: $('#use_owner_transport'+product_id).html())+
                parseFloat($('#departure_to_customer'+product_id).html().length==0?0: $('#departure_to_customer'+product_id).html())+
                parseFloat($('#service_costs'+product_id).html().length==0?0: $('#service_costs'+product_id).html())+
                parseFloat($('#other_gratitude'+product_id).html().length==0?0: $('#other_gratitude'+product_id).html())+
                parseFloat($('#loading_unloading'+product_id).html().length==0?0: $('#loading_unloading'+product_id).html())+
                parseFloat($('#bank_cost'+product_id).html().length==0?0: $('#bank_cost'+product_id).html())+
                parseFloat($('#other'+product_id).html().length==0?0: $('#other'+product_id).html())+
                parseFloat($('#incom_tax'+product_id).html().length==0?0: $('#incom_tax'+product_id).html())+
                parseFloat($('#VAT'+product_id).html().length==0?0: $('#VAT'+product_id).html());
//        console.log('full_price_costs', full_price_costs);
        $('#full_price_costs'+product_id).empty().html(full_price_costs);
        if($('#full_sale_price'+product_id).html().length>0){

            var absolute_diference = Math.round(($('#full_sale_price'+product_id).html()-full_price_costs)*100)/100;
            if(absolute_diference>0) {
                $('#absolute_diference' + product_id).removeClass('fielderror');
                $('#percent_diference'+product_id).removeClass('fielderror');
            }else {
                $('#absolute_diference' + product_id).addClass('fielderror');
                $('#percent_diference'+product_id).addClass('fielderror');
            }
            $('#absolute_diference'+product_id).html(absolute_diference);
            var percent_diference = Math.round((absolute_diference/$('#full_sale_price'+product_id).html())*100);
            $('#percent_diference'+product_id).html(percent_diference);




        }

//            console.log( full_price_costs);
    };
    $(document).ready(function(){
//        console.log('proposed_id', $.cookie('proposed_id'));
        $('.basic_part').show();
        $('.addition_part').hide();
        $('.result_part').hide();
        $('.features_part').hide();

        //clear empty cookie
        if($.cookie('proposed_id') != null) {
            var propos_array = $.cookie('proposed_id').split(',');
            for(var i = 0; i<propos_array.length; i++){
                if($.cookie('pr'+propos_array[i]) == null) {
                    propos_array.splice(i, 1);
//                    console.log('#Col'+propos_array[i], $('#Col'+propos_array[i]).text(), $.cookie('pr'+propos_array[i]));
                }
            }
            $.cookie('proposed_id', propos_array.toString());
//            console.log(propos_array );
        }

        var table = document.getElementsByTagName('table')[1];
        table.id = 'orderlist';
        var tr = $('#orderlist').find('tbody').find('tr');
        for (var i = 0; i < tr.length; i++) {
            var product_id = tr[i].id.substr(2);
            calculator(product_id);
        }
        $('.features_part').addClass('input');
        var tbody = $('.tabPage').find('tbody');
        var tr = tbody[0].getElementsByTagName('tr');
        if($.cookie('proposed_id') != null) {
            for(var i = 0; i<tr.length; i++){
                var td = tr[i].getElementsByTagName('td');
//                console.log(td[0]);
                if($('#art'+tr[i].id.substr(2)).attr('proposed') == '1'){
                    $('#'+tr[i].id).prepend('<td style="text-align: center; cursor: pointer" title="Видалити запропонований запис" onclick="deleteproposeditem('+tr[i].id.substr(2)+');"><img src="/dolibarr/htdocs/theme/eldy/img/delete.png"></td>');
                    for(var t = 0; t<3; t++){
                        if(td[t].id.length == 0) {
                            switch (t) {
                                case 1:
                                {
                                    td[t].id = "producer"+tr[i].id.substr(2);
                                }break;
                                case 2:
                                {
                                    td[t].id = "name"+tr[i].id.substr(2);
                                }break;
                            }
                        }
                        $('#'+td[t].id).addClass('proposed');
                        $('#'+td[t].id).attr('title', 'Запропоновано');
                        if(!$('#'+td[4].id).hasClass('input')){
//                            console.log($('#'+td[4].id).hasClass('input'));
                            $('#'+td[4].id).addClass('input');
                        }
                    }
                }else{
                    $('#'+tr[i].id).prepend('<td>&nbsp;</td>');
//                    console.log('add');
                }
            }
//            console.log(tr.length)
        }else{
            for(var i = 0; i<tr.length; i++) {
                $('#'+tr[i].id).prepend('<td>&nbsp;</td>');
            }
        }
    })
    $(window).click(function(){
        if(location.href.substr(strpos(location.href, "#")) == '#close'){
            $('#popupmenu').hide();
        }
    });
    $(function(){
        $('td').click(function(e){
            if($(this).hasClass('input') && $('#edit').length == 0) {
               var product_id = $(this).parent().attr('id').substr(2);
//                console.log($('#edit').length);
//                return;
                if(e.target.id.substr(0,3) == 'Col'){
//                    console.log(e.target.id);
                    product_id = e.target.id.substr(3);
                    var full_sale_price = parseFloat($('#full_sale_price'+product_id).html());
                    var dCol_ed = parseFloat($('#Col'+product_id).html());
                    var UnitPrice = full_sale_price/dCol_ed;
                }
                var val = $(this).html();
                var field = '<input type="text" id="edit" value="'+val+'" '+($(this).hasClass('features_part')?'style="width:100%"':'size=4')+'>';
                $(this).empty().append(field); //устанавливаем фокус на свеженарисованное поле
                $('#edit').focus();
                $('#edit').select();
                $('#edit').blur(function() { //устанавливаем обработчик
                    var val = $(this).val(); //получаем то, что в поле находится
                    //находим ячейку, опустошаем, вставляем значение из поля
                    $(this).parent().empty().html(val);

                    if($(this).hasClass('features_part'))
                        return;

                    if(e.target.id.substr(0,3) == 'Col'){
                        dCol_ed = parseFloat(val);
                        var FullPrice = dCol_ed*UnitPrice;
                        console.log(FullPrice, product_id);
                        $('#full_sale_price'+product_id).empty();
                        $('#full_sale_price'+product_id).html(FullPrice.toString());
                    }

                    if(e.target.id.substr(0, ('full_price_per_unit').length) == 'full_price_per_unit'){
                        $('#price_per_unit'+product_id).empty().html(Math.round(val/1.2*100)/100);
                        var price_per_party = $('#Col'+product_id).html()*$('#price_per_unit'+product_id).html();
                        $('#price_per_party'+product_id).empty().html(Math.round(price_per_party/1.2*100)/100);
                        var full_price_per_party = $('#Col'+product_id).html()*val;
                        $('#full_price_per_party'+product_id).empty().html(full_price_per_party);
                    }else if(e.target.id.substr(0, ('full_price_per_transport').length) == 'full_price_per_transport'){
                        var col_id =  e.target.id.substr('full_price_per_transport'.length, 1);
                        $('#price_per_transport'+col_id+product_id).empty().html(Math.round(val/1.2*100)/100);
                    }else if(e.target.id.substr(0, ('full_sale_price').length) == 'full_sale_price'){
                        $('#sale_price'+col_id+product_id).empty().html(Math.round(val/1.2*100)/100);
                    }
                    calculator(product_id);
                    var td = $('#'+e.target.id).parent();

                });
            }
        });

    })
    function deleteproposeditem(id){
        if(confirm('Видалити запропонований запис?')){
            var proposed_array = $.cookie('proposed_id').split(',');
            var index = $.inArray(id.toString(), proposed_array);
            proposed_array.splice($.inArray(id.toString(), proposed_array), 1);
            console.log(proposed_array.toString());
            $.cookie('proposed_id', proposed_array.toString());
            $.cookie('pr'+id, null);
            $('#tr'+id).remove();

        }
    }
    function selpage(event){
        $('.basic_part').hide();
        $('#basic_part').addClass('unactivepage');
        $('.addition_part').hide();
        $('#addition_part').addClass('unactivepage');
        $('.result_part').hide();
        $('#result_part').addClass('unactivepage');
        $('.features_part').hide();
        $('#features_part').addClass('unactivepage');
        $('.'+event.target.id).show();
        $('#'+event.target.id).removeClass('unactivepage');
    }
    function saveorders(){
        if(confirm('Зберегти звіт?')) {
//Col
//Ed
//price_per_unit
//full_price_per_unit
//price_per_party
//full_price_per_party
//price_per_download
//price_per_transport
//full_price_per_transport1
//price_per_transport2
//full_price_per_transport2
//price_per_transport3
//full_price_per_transport3
//prep_sale
//use_owner_transport
//departure_to_customer
//service_costs
//other_gratitude
//loading_unloading
//bank_cost
//other
//incom_tax
//VAT
//price_costs
//full_price_costs
//sale_price
//full_sale_price
//absolute_diference
//percent_diference
//min_advance
//dead_line_advance
//dead_line_payment
//supply
//note
            var tr = $('#orderlist').find('tbody').find(('tr'));
            $.each(tr, function(key){
                var id = tr[key].id.substr(2);
                var td = $('#'+tr[key].id).find('td');
                var proposed = $('#producer'+id).hasClass('proposed');
                var item = {'type_action':'savepreparedraport',
                            'rowid':$('td#art'+id).attr('rowid'),
                            'fk_product_id':id,
                            'proposed':proposed,
                            'fk_order':'<?=$_GET["order_id"]?>',
                            'Col':$('td#Col'+id).text(),
                            'price_per_unit':$('td#price_per_unit'+id).text(),
                            'full_price_per_unit':$('td#full_price_per_unit'+id).text(),
                            'price_per_party':$('td#price_per_party'+id).text(),
                            'full_price_per_party':$('td#full_price_per_party'+id).text(),
                            'price_per_download':$('td#price_per_download'+id).text(),
                            'price_per_transport':$('td#price_per_transport'+id).text(),
                            'full_price_per_transport1':$('td#full_price_per_transport1'+id).text(),
                            'price_per_transport2':$('td#price_per_transport2'+id).text(),
                            'full_price_per_transport2':$('td#full_price_per_transport2'+id).text(),
                            'price_per_transport3':$('td#price_per_transport3'+id).text(),
                            'full_price_per_transport3':$('td#full_price_per_transport3'+id).text(),
                            'prep_sale':$('td#prep_sale'+id).text(),
                            'use_owner_transport':$('td#use_owner_transport'+id).text(),
                            'departure_to_customer':$('td#departure_to_customer'+id).text(),
                            'service_costs':$('td#service_costs'+id).text(),
                            'other_gratitude':$('td#other_gratitude'+id).text(),
                            'loading_unloading':$('td#loading_unloading'+id).text(),
                            'bank_cost':$('td#bank_cost'+id).text(),
                            'other':$('td#other'+id).text(),
                            'incom_tax':$('td#incom_tax'+id).text(),
                            'VAT':$('td#VAT'+id).text(),
                            'price_costs':$('td#price_costs'+id).text(),
                            'full_price_costs':$('td#full_price_costs'+id).text(),
                            'sale_price':$('td#sale_price'+id).text(),
                            'full_sale_price':$('td#full_sale_price'+id).text(),
                            'absolute_diference':$('td#absolute_diference'+id).text(),
                            'percent_diference':$('td#percent_diference'+id).text(),
                            'min_advance':$('td#min_advance'+id).text(),
                            'dead_line_advance':$('td#dead_line_advance'+id).text(),
                            'dead_line_payment':$('td#dead_line_payment'+id).text(),
                            'supply':$('td#supply'+id).text(),
                            'note':$('td#note'+id).text(),
                        }
                $.ajax({
                    dataType: 'json',
                    url:'/dolibarr/htdocs/orders.php',
                    data:item,
                    cache:false,
                    success:function(result){
                    },
                    type: 'post'
                })
            })
        }
    }
    function preparedorders(){
            $('.popupmenu').hide();
            $('#typicalqueries').css('position', "absolute");
            $('#typicalqueries').css("top", '150');
            $('#typicalqueries').css("z-index", '1500000');
            $('#typicalqueries').css("left", (($(window).width() - 458) / 2));
//            location.href = '#login_phone';
            $.ajax({
            url: '<?=$_SERVER["PHP_SELF"]?>?type_action=get_typical_question',
            cashe: false,
            success: function(html){
                $('#questions').html(html);
                }
            })
        $('#typicalqueries').show();
    }
    function showTotalPrice(){
        var table = document.getElementsByTagName('table')[1];
        table.id = 'popup_table';
        var tr = table.getElementsByTagName('tr');
        var TotalPrice = 0
        for(var i = 0; i<tr.length; i++){
            var id = tr[i].id.substr(2);
            if($('#popup_table').find('#price'+id).length)
                TotalPrice += $('#popup_table').find('#price'+id).html()*$('#popup_table').find('#td'+id).html();
            console.log($('#popup_table').find('#price'+id).html(), $('#popup_table').find('#td'+id).html());
        }
        $('#total_price').html('Загалом на суму '+TotalPrice);
    }
    function showorders(){
        $.ajax({
            url: '<?=$_SERVER["PHP_SELF"]?>?type_action=showorders',
            cashe: false,
            success: function(html){
                $('#popup_table').html(html);
                var tr = document.getElementById('popup_table').getElementsByTagName('tbody')[0].getElementsByTagName('tr');
                var TotalPrice = 0
                for(var i = 0; i<tr.length; i++){
                    var id = tr[i].id.substr(2);
                    TotalPrice += $('#popup_table').find('#price'+id).html()*$('#popup_table').find('#td'+id).html();
                }
                $('#total_price').html('Загалом на суму '+TotalPrice);
            }
        })
        $('#popupmenu').css('position', "absolute");
        $('#popupmenu').css("top", '150');
        $('#popupmenu').css("z-index", '1500000');
        $('#popupmenu').css("left", (($(window).width() - 458) / 2));
        location.href = '#login_phone';
        $('#popupmenu').show();
    }
    function  get_choosed_products(){
        $.ajax({
            url: '<?=$_SERVER["PHP_SELF"]?>?type_action=get_choosed_product',
            cashe: false,
            success: function(html){
                var result = html;
                var products_id = result.split(';');
                for(var i=0; i<products_id.length-1; i++) {
                    var row = products_id[i].split('=');
                    $('#Col'+row[0]).val(row[1]);
                }
            }
        })
    }

    $(window).keydown(function(event){ //ловим событие нажатия клавиши
//        console.log(event.keyCode);
        if(event.keyCode == 13 || event.keyCode == 9) { //если это Enter
            event.target.blur(event);
        }
    });
    function setProductCount(elem){
//        console.log('test', $('#'+elem.id).val());
        $.ajax({
            url: '<?=$_SERVER["PHP_SELF"]?>?type_action=choose_product&product_id='+elem.id.substr(3)+'&count='+$('#'+elem.id).val()+'&id_usr=<?=$user->id?>',
            cashe: false,
            success: function(html){

            }
        })

    }
    function close_action(){
        location.href = '#x';
        $('#actionform').hide();
    }
    function choose_product(id){
        var img = $('#img'+id).attr('src');
        var insert = false;
        if(img.substr(img.length-'uncheck.png'.length)=='uncheck.png'){
            insert = true;
            $('#img'+id).attr('src', '/dolibarr/htdocs/theme/eldy/img/check.png');
        }else{
            $('#img'+id).attr('src', '/dolibarr/htdocs/theme/eldy/img/uncheck.png');
        }
        var action = (insert==true?'insert':'delete');

        $.ajax({
            url:'<?=$_SERVER["PHP_SELF"]?>?type_action=choose_product&action='+action+'&product_id='+id,
            cache:false,
            success:function(html){
                console.log(html);
            }
        })
    }
    function choose_action(){
        $('#choose_typeaction').submit();
    }
    function strpos( haystack, needle, offset){ // Find position of first occurrence of a string
        var i = haystack.indexOf( needle, offset ); // returns -1
        return i >= 0 ? i : false;
    }
</script>

<?=$actionform?>

