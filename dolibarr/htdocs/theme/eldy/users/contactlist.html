<div class="tabs" id="usertabs" data-role="controlgroup" data-type="horizontal">
    <div class="inline-block tabsElem">
        <a id="user" class="tab inline-block" data-role="button" href="?idmenu=10427&mainmenu=coworkers&leftmenu=&list=userlist"><?echo $langs->trans('UserList')?></a>
    </div>
    <div  class="inline-block tabsElem tabsElemActive">
        <a href="?idmenu=10427&mainmenu=coworkers&leftmenu=&list=contactlist"class="tabactive tab inline-block" data-role="button"><b>Налагодження комунікацій</b></a>
    </div>
    <?if(in_array($user->id,array(1,5,6))){?>
        <div  class="inline-block tabsElem" id="Raport">
            <a href="?idmenu=10427&mainmenu=coworkers&leftmenu=&list=callstatistic"class="tab inline-block" data-role="button"><b>Звіт по дзвінкам</b></a>
        </div>
    <?}?>
</div>
<table cellspacing="1" class="WidthScroll" >
    <thead style="width: 100%">
        <tr  class="multiple_header_table">
            <td style="width: 205px">Група організаційних питань</td>
            <td style="width: 141px">Підрозділ/місто</td>
            <td style="width: 205px">Дія</td>
            <td style="width: 200px">Відповідальний</td>
            <td style="width: 231px">Безпосередній відповідальний</td>
            <td></td>
        </tr>
        <tr  class="multiple_header_table">
            <form id="filter" action="" method="post">
            <td><?=$form->GroupOfIssues($obj->$fieldlist[$field], 'fk_groupissues')?></td>
            <td><?=$form->select_control($obj->$fieldlist[$field], 'fk_subdivision', 0, 'subdivision', 'name', $object, false)?></td>
            <td><input id="action" class="ui-autocomplete-input" autocomplete="off" type="text" name="action" style="width: 100%"></td>
            <!--<td><input id="responsible" type="text" name="responsible" style="width: 100%"></td>-->
            <td><?=showResponsible()?></td>
            <!--<td><input id="directly_responsible" type="text" name="directly_responsible" style="width: 100%"></td>-->
            <td><?=showDirectlyResponsible()?></td>
            </form>
            <td><button onclick="setFilter();">Встановити фільтр</button></br><button style="width: 100%" onclick="ClearFilter();">Очистити фільтр</button></td>
        </tr>
    </thead>
    <?=$tbody;?>
</table>
<script>
    $('#dict').height($(window).height() - 250);
//    console.log($('#dict').attr('overflow'));
    $("#fk_groupissues [value='<?=$_POST['fk_groupissues']?>']").attr('selected', 'selected');
    $("#fk_subdivision [value='<?=$_POST['fk_subdivision']?>']").attr('selected', 'selected');
    $('#action').val("<?=$_POST['action']?>");
    $('#responsible').val("<?=$_POST['responsible']?>");
    $('#directly_responsible').val("<?=$_POST['directly_responsible']?>");
    function ShowAutocomplete(){

    }
    $(function () {
//        var test = ['1','12','13','14','15','16','17'];
        $('#action').autocomplete({
            source: function(req, add){
                var param = {
                    action:'getAction',
                    find:req
                };
                $.ajax({
                    url:'/dolibarr/htdocs/user/list.php',
                    data:param,
                    cache:false,
                    success:function (result) {
                        add($.parseJSON(result));
                    }
                })
            }
        });
    })

    $(document).ready(function () {
        var thList = $("thead").find("tr")
        var resThList = [];
        var secIndex = 0;
        console.log($(thList[0]).find("td"));

        $.each($(thList[0]).find("td"), function(key, value){
            if($(value).attr("colspan") == undefined)
                resThList.push(value);
//            else{
//                for(var i = 1; i<=$(value).attr("colspan"); i++)
//                    resThList.push($(thList[1]).find("th")[secIndex++]);
//                key++;
//            }
        });
        console.log(resThList);
        var trList = document.getElementById("dict").getElementsByTagName("tr")[0];
        var tdList = trList.getElementsByTagName("td")
        for(var i = 0; i<$(tdList).length; i++){
            if(tdList[i+1] !== undefined){
                var width = $(tdList[i]).width();
                $(tdList[i]).width($(tdList[i]).width() + ($(resThList[i+1]).offset().left - $(tdList[i+1]).offset().left));
                if($(resThList[i+1]) !== undefined && ($(resThList[i+1]).offset().left - $(tdList[i+1]).offset().left) != 0){
                    $(resThList[i]).width($(tdList[i]).width() - ($(resThList[i+1]).offset().left - $(tdList[i+1]).offset().left));
                    console.log(resThList, $(resThList[i+1]).offset());
                    console.log($(tdList[i]), $(resThList[i]),width," => ",$(tdList[i]).width(), ($(resThList[i+1]).offset().left - $(tdList[i+1]).offset().left));
                }
            }
        }
    })
    function setFilter(){
        $('form#filter').submit();
    }
    function ClearFilter(){
        $("#fk_groupissues [value='-1']").attr('selected', 'selected');
        $("#fk_subdivision [value='0']").attr('selected', 'selected');
        $("#action").val('');
        $("#responsible").val('');
        $("#directly_responsible").val('');
        $('form#filter').submit();
    }
</script>
<style>
    .WidthScroll{
        padding-top: 0!important;
    }
</style>